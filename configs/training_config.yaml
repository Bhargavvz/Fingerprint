# Training Configuration - Optimized for 95%+ Accuracy
# Single-GPU training (simpler and more reliable)

# Model Configuration
model:
  name: "efficientnet_b3_cbam"
  pretrained: true
  num_classes: 8
  dropout: 0.5  # Increased for regularization
  attention_reduction: 16
  use_gradient_checkpointing: false

# Data Configuration
data:
  root_dir: "Dataset"
  image_size: 224
  train_split: 0.70
  val_split: 0.15
  test_split: 0.15
  num_workers: 4
  pin_memory: true

# Blood Group Classes
classes:
  - "A+"
  - "A-"
  - "B+"
  - "B-"
  - "AB+"
  - "AB-"
  - "O+"
  - "O-"

# Training Configuration
training:
  batch_size: 32  # Smaller for better generalization
  epochs: 150
  early_stopping_patience: 25
  gradient_clip_max_norm: 1.0

# Optimizer Configuration - Lower LR for fine-tuning
optimizer:
  name: "adamw"
  lr: 0.0001  # Lower for stability
  weight_decay: 0.05
  betas: [0.9, 0.999]

# Learning Rate Scheduler
scheduler:
  name: "cosine_annealing_warm_restarts"
  T_0: 15
  T_mult: 2
  eta_min: 0.000001

# Loss Function
loss:
  name: "focal_loss"
  gamma: 2.0
  alpha: null
  label_smoothing: 0.15  # Increased for smoother predictions

# Data Augmentation
augmentation:
  train:
    horizontal_flip: true
    vertical_flip: false
    rotation: 15
    brightness: 0.2
    contrast: 0.2
    
    # MixUp and CutMix
    mixup:
      enabled: true
      alpha: 0.3  # Slightly reduced
    cutmix:
      enabled: true
      alpha: 1.0
    mix_probability: 0.4  # Reduced to preserve more real samples

  # Test-Time Augmentation
  tta:
    enabled: true
    transforms: ["horizontal_flip"]

# Mixed Precision Training
mixed_precision: true

# Checkpointing
checkpoint:
  save_dir: "checkpoints"
  save_best: true
  save_last: true
  save_every_n_epochs: 10
  monitor: "val_f1"
  mode: "max"

# Logging
logging:
  log_dir: "outputs/logs"
  tensorboard: true

# Output Configuration  
outputs:
  dir: "outputs"
  save_training_curves: true
  save_confusion_matrix: true
  save_roc_curves: true
  save_per_class_metrics: true

# Random Seed
seed: 42

# Device
device: "auto"
